# SQL

SQL (аббр. от англ. Structured Query Language — «язык структурированных запросов») — декларативный язык программирования, применяемый для создания, модификации и управления данными в реляционной базе данных, управляемой соответствующей системой управления базами данных.

Является, прежде всего, информационно-логическим языком, предназначенным для описания, изменения и извлечения данных, хранимых в реляционных базах данных. В общем случае SQL (без ряда современных расширений) считается языком программирования неполным по Тьюрингу, но вместе с тем стандарт языка спецификацией SQL/PSM предусматривает возможность его процедурных расширений.

Изначально SQL был основным способом работы пользователя с базой данных и позволял выполнять следующий набор операций:

- создание в базе данных новой таблицы;
- добавление в таблицу новых записей;
- изменение записей;
- удаление записей;
- выборка записей из одной или нескольких таблиц (в соответствии с заданным условием);
- изменение структур таблиц.

## Что такое реляция в базах данных?

Слово "реляция" происходит от "relation", то есть "отношение". Это означает, что в РБД существуют механизмы установления связей между таблицами. Делается это с помощью так называемых первичных и внешних ключей.

Реляционная база данных – это набор данных с предопределенными связями между ними. Эти данные организованны в виде набора таблиц, состоящих из столбцов и строк. В таблицах хранится информация об объектах, представленных в базе данных.

Реляционной называется база данных, в которой все данные, доступные пользователю, организованы в виде таблиц, а все операции базы данных выполняются над этими таблицами.

## Ключи
Первичные ключи
Это  особенное поле в SQL-таблице, которое позволяет однозначно идентифицировать каждую запись в ней. Как правило, эти поля используются для хранения уникальных идентификаторов объектов, которые перечислены в таблице, например, это может быть ID клиента или товара.
Первичный ключ у каждой строки таблицы является уникальным в пределах таблицы, поэтому в таблице с первичным ключом нет двух совершенно одинако­вых строк. 

Внешние ключи
Столбец одной таблицы, значения в котором совпадают со значениями столбца, являющегося первичным ключом другой таблицы, называется внешним ключом (foreign key).

> Со временем SQL усложнился — обогатился новыми конструкциями, обеспечил возможность описания и управления новыми хранимыми объектами (например, индексы, представления, триггеры и хранимые процедуры) — и стал приобретать черты, свойственные языкам программирования.

> При всех своих изменениях SQL остаётся самым распространённым лингвистическим средством для взаимодействия прикладного программного обеспечения с базами данных. В то же время современные СУБД, а также информационные системы, использующие СУБД, предоставляют пользователю развитые средства визуального построения запросов.

Каждый оператор SELECT в UNION должен иметь одинаковое количество столбцов
Столбцы также должны иметь схожие типы данных
Столбцы в каждом заявлении SELECT также должны располагаться в том же порядке

## DDL, DML, DCL, TCL операции

Стандарты `SQL` подразделяют средства языка на несколько категорий:

1. Язык описания данных (`Data Definition Language, DDL`), команды которого определяют структуру базы данных (в томчисле логическую) и позволяют работать с объектами этой базы(например, с таблицами или представлениями), среди них:

- CREATE – создание нового объекта БД;

- ALTER – модификация/изменение существующего в БД объекта;

- DROP – удаление существующего в БД объекта;

- TRUNCATE – удаление (усечение) всех записей из таблицы или набора таблиц;

2. язык манипулирования данными (Data Manipulation Language, DML), команды которого обеспечивают управление данными внутри схемы, позволяют добавлять, изменять, удалять и выгружать данные из базы, среди них:

- SELECT – выборка данных;

- INSERT – вставка новых данных;

- UPDATE – обновление данных;

- DELETE – удаление данных;

- MERGE – слияние данных;

3. язык управления данными (Data Control Language, DCL), команды которого обеспечивают управление доступом к данным, т.е. управление привилегиями, разрешающими или запрещающими выполнение определенных операций над объектами базы данных, среди них:

- GRANT – предоставление пользователям привилегии доступа

- REVOKE – отзыв привилегии, предоставленной командой GRANT;

- DENY – задание запрета, имеющего приоритет над разрешением;

4. язык управления транзакциями (Transaction Control Language,TCL). Транзакция – это команда или блок DML команд, которые рассматриваются как единое целое, т.е. в успешной транзакции фиксируются все внесенные изменения, а при сбое в какой-либо команде транзакции все изменения, внесенные командами транзакции, будут отменены. Команды TCL используются для управления изменениями, сделанными транзакцией, среди них:

- BEGIN – определение начала транзакции;

- COMMIT – сохранение изменений;

- SAVEPOINT – определение точки транзакции, к которой можно будет откатиться;

- ROLLBACK – возвращение БД к состоянию на момент последней команды.



## Операторый SQL
select distinct - используется для выборки уникальных значений

where - для добовления условия выборки данных


and(логическое и) - выведет данные если в обоих случаех условие будет истинна

or(логическое или) - выведет даннве если  одно из условий истинна

not - выведет условие если оно не является истинным 

ORDER BY - используется для сортировки результирующего набора в порядке возрастания для сортивки по убыванию добовляем DESC.

UPDATE - используется для изменения существующих записей в таблице.  set испльзуется  для  выбарки столбцов в которых мы будем добовлять данные 

DELETE используется для удаления существующих записей в таблице. указывае where если нужно удалить конкретную запись из стобца

SELECT TOP -  используется для указания количества возвращаемых записей.

LIKE -  используется в предложении WHERE для поиска указанного шаблона в столбце

NULL - это поле без значения. синтаксис  is null или is not null

IN - позволяет указать несколько значений в предложении WHERE. Оператор IN это сокращенное выражение для нескольких условий OR

BETWEEN - выбирает значения в заданном диапазоне

as - используется для присвоения таблице или столбцу стаблице временного имени, псевдоним существует только на время выполнения запроса.

GROUP BY - группирует строки с одинаковыми значениями в сводные строки

HAVING была добавлена в SQL, поскольку ключевое слово WHERE не могло использоваться с агрегатными функциями.

Оператор EXISTS используется для проверки наличия любой записи в подзапросе. EXISTS возвращает true, если подзапрос возвращает одну или несколько записей.1

Оператор ANY возвращает true, если какое-либо из значений подзапроса удовлетворяет условию.

Оператор ALL возвращает true, если все значения подзапроса удовлетворяют условию.

SELECT INTO копирует данные из одной таблицы в новую.SQL использует предложение IN для копирования таблицы в новую таблицу в другой базе данных
` SELECT *
INTO newtable [IN externaldb]
FROM oldtable
WHERE condition; `

Инструкция INSERT INTO SELECT копирует данные из одной таблицы и вставляет их в другую таблицу. INSERT INTO SELECT требует, чтобы типы данных в исходной и целевой таблицах совпадали. Существующие записи в целевой таблице остаются неизменными

 CASE проходит через условия и возвращает значение, когда выполняется первое условие (например, инструкция IF-THEN-ELSE). Таким образом , как только условие истинно, оно прекратит чтение и вернет результат. Если никакие условия не являются истинными, он возвращает значение в предложении ELSE. Если нет никакой другой части и никакие условия не истинны, он возвращает NULL.

` SELECT OrderID, Quantity,
CASE
    WHEN Quantity > 30 THEN "Количество больше чем 30"
    WHEN Quantity = 30 THEN "Количество составляет 30"
    ELSE "Количество до 30"
END AS QuantityText
FROM OrderDetails; `

Вернет:

` 
OrderID	Quantity	QuantityText
10248	    12	   Количество до 30
10248	    10	   Количество до 30
10248   	5	     Количество до 30
10249	    9	     Количество до 30
10249	    40	   Количество больше чем 30
10250	    10	   Количество до 30
10250	    35	   Количество больше чем 30
10250	    15	   Количество до 30
10251	    6	     Количество до 30
10251	    15	   Количество до 30
10251	    20	   Количество до 30
10252	    40	   Количество больше чем 30 `

## Логический порядок обработки инструкции SELECT:

FROM

ON

JOIN

where

GROUP BY

WITH CUBE или WITH ROLLUP

HAVING

SELECT

DISTINCT

ORDER BY

TOP
